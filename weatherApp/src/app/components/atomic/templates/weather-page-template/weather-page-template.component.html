<!-- Main Scroll Container using Native CSS -->
<div
  class="w-full h-full overflow-y-auto overflow-x-hidden bg-[#121212] relative scroll-smooth"
>
  <div
    class="w-full pb-24 md:pb-0 pt-16 md:px-8 max-w-[1600px] mx-auto"
    [class.h-full]="showMap"
  >
    <!-- Header -->
    <app-weather-header></app-weather-header>

    <!-- Recent Searches (hidden when map is shown) -->
    <div class="md:px-6" *ngIf="!showMap">
      <app-recent-searches-list></app-recent-searches-list>
    </div>

    <!-- MAP VIEW -->
    <div
      *ngIf="showMap"
      class="h-[calc(100vh-200px)] md:h-[calc(100vh-180px)] mt-4"
    >
      <app-weather-map></app-weather-map>
    </div>

    <!-- WEATHER VIEW (hidden when map is shown) -->
    <ng-container *ngIf="!showMap">
      <!-- Main Content Area -->
      <div class="md:hidden">
        <!-- MÃ³vil: Layout simple sin grid -->
        <app-current-weather-display></app-current-weather-display>
        <app-quick-stats-panel></app-quick-stats-panel>
        <app-hourly-forecast-list></app-hourly-forecast-list>
        <div id="weekly-forecast">
          <app-weekly-forecast-list
            [days]="forecastDays"
          ></app-weekly-forecast-list>
        </div>
      </div>

      <!-- Desktop: Layout con grid centrado verticalmente -->
      <div class="hidden md:block md:mt-0">
        <ion-grid class="!p-0 w-full">
          <ion-row class="ion-align-items-start">
            <!-- LEFT COLUMN - Weather + Hourly Carousel -->
            <ion-col size="12" sizeMd="7" sizeLg="7" class="!px-0">
              <div class="flex flex-col gap-2">
                <!-- Current Weather Display -->
                <div class="px-0 md:px-6">
                  <app-current-weather-display></app-current-weather-display>
                </div>

                <!-- Hourly Forecast Carousel (below weather) -->
                <div class="px-0">
                  <app-hourly-forecast-list></app-hourly-forecast-list>
                </div>
              </div>
            </ion-col>

            <!-- RIGHT COLUMN - Stats (2x3) + Weekly Forecast -->
            <ion-col
              size="12"
              sizeMd="5"
              sizeLg="5"
              class="!px-0 md:!px-6 !pt-0"
            >
              <div class="flex flex-col gap-2 items-center">
                <!-- Quick Stats (2x3 grid) -->
                <div class="w-full">
                  <app-quick-stats-panel></app-quick-stats-panel>
                </div>

                <!-- Weekly Forecast (centered) -->
                <div id="weekly-forecast-desktop">
                  <app-weekly-forecast-list
                    [days]="forecastDays"
                  ></app-weekly-forecast-list>
                </div>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </ng-container>
  </div>
</div>

<!-- BOTTOM NAVIGATION -->
<div class="fixed bottom-0 left-0 right-0 z-50 md:hidden pb-safe">
  <app-bottom-navigation
    (navigationChange)="onNavigationChange($event)"
  ></app-bottom-navigation>
</div>

<!-- Desktop Navigation -->
<div class="hidden md:block fixed bottom-0 left-0 right-0 z-50">
  <app-bottom-navigation
    (navigationChange)="onNavigationChange($event)"
  ></app-bottom-navigation>
</div>

<!-- SETTINGS MODAL OVERLAY -->
<app-settings-modal [isOpen]="settingsModalOpen" (close)="onSettingsClose()">
</app-settings-modal>
